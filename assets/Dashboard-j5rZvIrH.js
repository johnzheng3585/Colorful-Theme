import{A as Pe,u as Oe,y as ts,c as g,b as _,e as os,f as rs,g as ls,h as l,n as S,i as e,k as h,j as c,t,m as ns,z as ne,l as ee,F as T,x as se,w as D,q as L,o,a as $,p as E,B as is,C as ds,D as cs}from"./index-YN2lenYj.js";import{a as us,g as hs,b as ps,c as vs,d as Te,r as Ae,e as ms,f as fs,h as _s}from"./user-D-2mtxQT.js";import{d as be}from"./marked.esm-DajSjiQI.js";import{_ as bs}from"./_plugin-vue_export-helper-D3si0jFD.js";import{c as A}from"./createLucideIcon-BQC_6rY1.js";import{C as Ie}from"./clock-CPyFzPHE.js";import{A as ys}from"./activity-DY0l3MP0.js";import{C as P,a as gs}from"./chevron-right-B_Iu7dS3.js";import{R as ks}from"./refresh-cw-BfY7PRsL.js";import{Z as ae}from"./zap-DImEQRF4.js";import{C as ws}from"./copy-luIW5yos.js";import{C as Be}from"./credit-card-Fub2rKCz.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=A("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=A("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=A("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=A("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=A("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=A("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=A("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=A("zap-off",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),xs="/images/clients/Clash.webp",Rs="/images/clients/Shadowrocket.webp",zs="/images/clients/Singbox.svg",Ds="/images/clients/Surfboard.svg",Ms="/images/clients/Surge.svg",Os="/images/clients/Quantumult.webp",Ts={class:"dark-tech-dashboard"},As={key:0,class:"status-alerts animate-fade-in"},Is={key:0,class:"alert-banner info"},Bs={class:"alert-content"},Ls={class:"alert-text"},Es={class:"alert-title"},Ps={class:"alert-desc"},Js={key:1,class:"alert-banner error"},Us={class:"alert-content"},qs={class:"alert-text"},Hs={class:"alert-title"},Vs={class:"alert-desc"},Fs={key:2,class:"alert-banner error"},js={class:"alert-content"},Gs={class:"alert-text"},Ks={class:"alert-title"},Ws={class:"alert-desc"},Qs={key:3,class:"alert-banner warning"},Xs={class:"alert-content"},Zs={class:"alert-text"},Ys={class:"alert-title"},ea={class:"alert-desc"},sa={key:4,class:"alert-banner warning"},aa={class:"alert-content"},ta={class:"alert-text"},oa={class:"alert-title"},ra={class:"alert-desc"},la={class:"bento-grid"},na={class:"subscription-hero glass-card bento-item lg:col-span-8"},ia={key:0,class:"hero-content"},da={class:"user-meta"},ca={class:"user-titles"},ua={class:"greeting"},ha={class:"user-info-row"},pa={class:"plan-tag"},va={class:"c-text"},ma={class:"c-text"},fa={class:"metric-grid"},_a={class:"metric-item glass-card"},ba={class:"m-header"},ya={class:"m-label"},ga={class:"m-value"},ka={key:0,class:"m-footer"},wa={class:"m-subtext"},Ca={class:"metric-item glass-card"},Sa={class:"m-header"},$a={class:"m-label"},Na={class:"m-value"},xa={key:0,class:"m-footer"},Ra={class:"m-subtext"},za={key:1,class:"m-footer"},Da={class:"m-subtext"},Ma={class:"metric-item glass-card highlight"},Oa={class:"m-header"},Ta={class:"m-label"},Aa={class:"m-value text-primary"},Ia={class:"m-footer"},Ba={class:"m-subtext"},La={key:1,class:"hero-skeleton-wrap"},Ea={key:2,class:"hero-empty-state"},Pa={class:"notification-wall glass-card bento-item lg:col-span-4"},Ja={class:"card-header"},Ua={key:0,class:"notice-list"},qa=["onClick"],Ha={class:"n-body"},Va={class:"n-title"},Fa={class:"n-time"},ja={key:1,class:"notice-empty"},Ga={class:"subscribe-section glass-card bento-item lg:col-span-12"},Ka={class:"sub-layout"},Wa={class:"sub-left"},Qa={class:"sub-section"},Xa={class:"link-input-group"},Za=["value"],Ya={class:"sub-section"},et={class:"quick-icons"},st={class:"qr-code-box"},at={class:"sub-right"},tt={class:"client-downloads"},ot=["href"],rt=["src","alt"],lt={class:"dl-info"},nt={class:"dl-name"},it={class:"dl-platform"},dt=["onClick"],ct={class:"modal-title-custom"},ut={class:"title-icon"},ht={class:"title-text"},pt={class:"promo-card"},vt={class:"promo-header"},mt=["innerHTML"],ft={class:"promo-body"},_t={class:"promo-desc"},bt={key:0,class:"promo-code-box"},yt={class:"code-label"},gt={class:"code-val"},kt={key:0,class:"promo-action"},wt=["innerHTML"],Ct={class:"notice-detail-footer"},St={class:"info-badge"},$t={class:"checkin-modal-content"},Nt={class:"checkin-header"},xt={class:"checkin-icon-wrap"},Rt={class:"checkin-title"},zt={class:"checkin-subtitle"},Dt={class:"checkin-stats"},Mt={class:"stat-card"},Ot={class:"stat-val"},Tt={class:"stat-lab"},At={key:0,class:"reward-box animate-bounce-in"},It={class:"reward-content"},Bt={class:"reward-info"},Lt={class:"reward-label"},Et={class:"reward-value"},Pt={class:"checkin-actions"},Jt={class:"redeem-modal-content"},Ut={class:"redeem-tabs"},qt={key:0,class:"redeem-pane"},Ht={class:"redeem-header"},Vt={class:"redeem-icon-wrap"},Ft={key:0,class:"redeem-title"},jt={key:1,class:"redeem-title success"},Gt={key:0,class:"redeem-form-area"},Kt={class:"redeem-input-section"},Wt=["placeholder","disabled"],Qt={class:"redeem-actions"},Xt={key:1,class:"redeem-result-area animate-in"},Zt={class:"result-badge"},Yt={class:"result-desc"},eo={class:"reward-list-mini"},so={class:"reward-val"},ao={key:1,class:"reward-item-simple"},to={key:1,class:"history-pane"},oo={key:0,class:"history-loading"},ro={key:1,class:"history-empty"},lo={key:2,class:"history-empty"},no={key:3,class:"history-list"},io={class:"h-icon"},co={class:"h-info"},uo={class:"h-top"},ho={class:"h-name"},po={class:"h-time"},vo={class:"h-bottom"},mo={class:"h-code"},fo={class:"modal-title"},_o={key:0,class:"doc-loading"},bo=["innerHTML"],yo={components:{AQrcode:Pe}},go=Object.assign(yo,{__name:"Dashboard",setup(ko){be.setOptions({breaks:!0,gfm:!0,headerIds:!0,mangle:!1});const N=ns(),{t:u}=Oe(),Je=ts(),ke=g(()=>Je.theme==="dark"),ie=ls(),r=_(JSON.parse(localStorage.getItem("xboard_subscribe_info")||"null")),q=os(JSON.parse(localStorage.getItem("xboard_user_info")||'{"email":""}')),te=_({}),I=_(JSON.parse(localStorage.getItem("xboard_notices")||"[]")),k=_(null),H=_(!1),de=_(!1),x=_(null),ce=_(!1),ue=_(!1),R=_(null),he=_(!1),z=_(""),V=_(!1),B=_("redeem"),oe=_([]),pe=_(!1),M=_(!0),we=_(!1),w=_(null),F=_(!1),ve=_(!1),J=_(null),Ce=_(!1),{locale:Ue}=Oe(),re=g(()=>!r.value||!r.value.plan_id),Se=g(()=>!r.value||!r.value.expired_at||r.value.expired_at===0?!1:r.value.expired_at<Date.now()/1e3),me=g(()=>{var s;return!((s=r.value)!=null&&s.expired_at)||r.value.expired_at===0?0:Math.ceil((r.value.expired_at-Date.now()/1e3)/(24*3600))}),$e=g(()=>me.value>0&&me.value<=3),fe=g(()=>r.value?r.value.transfer_enable-(r.value.u+r.value.d)<=0:!1),Ne=g(()=>!r.value||fe.value?!1:r.value.transfer_enable-(r.value.u+r.value.d)<1024*1024*1024),xe=s=>{if(s===0)return"0 B";const a=1024,i=["B","KB","MB","GB","TB"],f=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,f)).toFixed(2))+" "+i[f]},qe=g(()=>{if(re.value)return u("dashboard.home.noPlan");if(!r.value||!r.value.expired_at)return u("dashboard.home.forever");const s=r.value.expired_at-Date.now()/1e3;return s<=0?u("dashboard.home.expired"):Math.ceil(s/(24*3600))+" "+u("dashboard.home.daysLaterResetShort")}),He=g(()=>{if(re.value)return u("dashboard.home.noPlan");const s=r.value.reset_day;if(s!=null&&s!==0){const a=new Date,i=a.getDate(),f=new Date(a.getFullYear(),a.getMonth()+1,0).getDate();let m=0;return s>i?m=s-i:s===i?m=0:m=f-i+s,m+" "+u("dashboard.home.daysLaterResetShort")}return u("dashboard.home.forever")}),Re=g(()=>{if(!r.value||!r.value.plan_id)return"";const s=r.value.reset_day;return s!=null&&s!==0?u("dashboard.home.resetDayNumberedShort",{day:s}):""}),ze=g(()=>{if(!r.value||!r.value.plan)return u("dashboard.home.trafficNoReset");const s=r.value.plan.reset_traffic_method;return u(s===0?"dashboard.home.trafficNoReset":s===1?"dashboard.home.trafficResetMonthly":s===2?"dashboard.home.trafficResetYearly":"dashboard.home.trafficReset")}),C=g(()=>{var s;if(!((s=k.value)!=null&&s.content))return null;try{const a=k.value.content.trim();if(a.startsWith("{")&&a.endsWith("}")){const i=JSON.parse(a);if(i&&i.cardComponent)return i}}catch{}return null}),Ve=g(()=>{var s;if(!((s=k.value)!=null&&s.content)||C.value)return"";try{return be.parse(k.value.content)}catch(a){return console.error("Markdown parsing error:",a),k.value.content}}),Fe=s=>{k.value=s,H.value=!0},je=s=>{s&&(s.startsWith("http")?window.open(s,"_blank"):(N.push(s),H.value=!1))},Ge=()=>{if(Ce.value||(Ce.value=!0,!I.value||I.value.length===0))return;const s=JSON.parse(localStorage.getItem("xboard_popup_notice_read")||"{}"),a=I.value.find(i=>{if(s[i.id])return!1;if(i.tags){let f="";return typeof i.tags=="string"?f=i.tags:Array.isArray(i.tags)&&(f=i.tags.join(",")),f.includes("å¼¹çª—")||f.includes("popup")||f.includes("Popup")||f.includes("POPUP")}return!1});a&&setTimeout(()=>{k.value=a,H.value=!0,Ke(a.id)},500)},Ke=s=>{const a=JSON.parse(localStorage.getItem("xboard_popup_notice_read")||"{}");a[s]=Date.now(),localStorage.setItem("xboard_popup_notice_read",JSON.stringify(a))};rs(async()=>{r.value||(de.value=!0),await _e(),ie.enableDailyCheckin&&await Xe(),es(),Ge(),de.value=!1;try{const s=localStorage.getItem("xboard_client_config");s&&(te.value=JSON.parse(s));const i=await(await fetch("/clientConfig.json")).json();i.downloads&&(te.value=i.downloads,localStorage.setItem("xboard_client_config",JSON.stringify(i.downloads)))}catch{te.value={windows_android:{title:"Windows / Android",clients:[{name:"Clash Verge",platform:"Windows",icon:"/images/clients/Clash.webp",url:"https://clashverge.dev/",tutorial_url:"",tutorial_id:""},{name:"Surfboard",platform:"Android",icon:"/images/clients/Surfboard.svg",url:"https://manual.getsurfboard.com/",tutorial_url:"",tutorial_id:""}]},macos_ios:{title:"macOS / iOS",clients:[{name:"Clash Verge",platform:"macOS",icon:"/images/clients/Clash.webp",url:"https://clashverge.dev/",tutorial_url:"",tutorial_id:""},{name:"Shadowrocket",platform:"iOS",icon:"/images/clients/Shadowrocket.webp",url:"https://apps.apple.com/app/shadowrocket/id932747118",tutorial_url:"",tutorial_id:""}]}}}});const We=async s=>{if(s.tutorial_url){window.open(s.tutorial_url,"_blank");return}if(s.tutorial_id){J.value=null,F.value=!0,ve.value=!0;try{const a=await ms({language:Ue.value==="zh-CN"?"zh-CN":"en"});if(a.data){let i=null;Object.keys(a.data).forEach(f=>{const m=a.data[f].find(O=>O.id==s.tutorial_id);m&&(i=m)}),i?J.value=i:(N.push({name:"Knowledge",query:{id:s.tutorial_id}}),F.value=!1)}}catch{N.push({name:"Knowledge",query:{id:s.tutorial_id}}),F.value=!1}finally{ve.value=!1}}else N.push("/knowledge")},Qe=g(()=>{var s;if(!((s=J.value)!=null&&s.body))return"";try{return be.parse(J.value.body)}catch{return J.value.body}}),_e=async()=>{try{const[s,a,i]=await Promise.all([us(),hs(),ps()]);s.data&&JSON.stringify(s.data)!==JSON.stringify(r.value)&&(r.value=s.data,localStorage.setItem("xboard_subscribe_info",JSON.stringify(s.data))),a.data&&JSON.stringify(a.data)!==JSON.stringify(q)&&(Object.assign(q,a.data),localStorage.setItem("xboard_user_info",JSON.stringify(a.data))),i.data&&JSON.stringify(i.data)!==JSON.stringify(I.value)&&(I.value=i.data,localStorage.setItem("xboard_notices",JSON.stringify(i.data)))}catch{}},Xe=async()=>{try{const s=await vs();s.data&&(x.value=s.data,s.data.checked_in_today&&(s.data.reward_type==="traffic"?R.value={type:"traffic",value:s.data.reward_traffic,unit:"MB"}:s.data.reward_type==="days"&&(R.value={type:"days",value:s.data.reward_days,unit:u("dashboard.home.checkinDays")})))}catch(s){console.error("Fetch checkin status error:",s)}},Ze=()=>{ce.value=!0},Ye=async()=>{var s;if(!((s=x.value)!=null&&s.checked_in_today)){ue.value=!0;try{const a=await fs();a.data&&(x.value={checked_in_today:!0,streak_days:a.data.streak_days,reward_type:a.data.reward_type,reward_traffic:a.data.reward_traffic,reward_days:a.data.reward_days},a.data.reward_type==="traffic"?R.value={type:"traffic",value:a.data.reward_traffic,unit:"MB"}:R.value={type:"days",value:a.data.reward_days,unit:u("dashboard.home.checkinDays")},L.success(u("dashboard.home.checkinSuccess")),await _e())}catch{}finally{ue.value=!1}}},es=async()=>{var i,f;let s=!1,a=!1;try{await Te({page:1,per_page:1},{hideError:!0}),s=!0,M.value=!0}catch(m){((i=m.response)==null?void 0:i.status)===404||m.code==="ERR_NETWORK"||!m.response?(s=!1,M.value=!1):(s=!0,M.value=!0)}try{await Ae({code:""},{hideError:!0}),a=!0}catch(m){((f=m.response)==null?void 0:f.status)===404||m.code==="ERR_NETWORK"||!m.response?a=!1:a=!0}we.value=s||a},ss=async()=>{var s;if(!(!M.value&&oe.value.length===0)){pe.value=!0;try{const a=await Te({page:1,per_page:20},{hideError:!0});a.data&&(oe.value=Array.isArray(a.data)?a.data:a.data.data||[],M.value=!0)}catch(a){(((s=a.response)==null?void 0:s.status)===404||a.code==="ERR_NETWORK"||!a.response)&&(M.value=!1,B.value==="history"&&(B.value="redeem"))}finally{pe.value=!1}}},De=async()=>{var m,O,j,G,K,W,Q,X,Z,Y,n,p,y;if(!z.value)return;const s=q.balance||0,a=((m=r.value)==null?void 0:m.transfer_enable)||0,i=((O=r.value)==null?void 0:O.expired_at)||0,f=((j=r.value)==null?void 0:j.plan_id)||null;V.value=!0;try{let v;try{console.log("[ç¤¼å“å¡] å°è¯•ä½¿ç”¨çŽ°ä»£API: /user/gift-card/redeem"),v=await _s({code:z.value},{hideError:!0}),console.log("[ç¤¼å“å¡] çŽ°ä»£APIæˆåŠŸ")}catch(d){const b=((G=d.response)==null?void 0:G.status)===404,le=!d.response&&(d.code==="ERR_NETWORK"||d.message==="Network Error");if(b||le)console.log(`[ç¤¼å“å¡] çŽ°ä»£APIä¸å¯ç”¨(åŽŸå› : ${b?"404":"CORS/ç½‘ç»œé”™è¯¯"}), å°è¯•ä¼ ç»ŸAPI`),v=await Ae({code:z.value,giftcard:z.value},{hideError:!0}),console.log("[ç¤¼å“å¡] ä¼ ç»ŸAPIæˆåŠŸ");else throw d}if(v.data){if(console.log("[ç¤¼å“å¡] APIè¿”å›žæ•°æ®:",JSON.stringify(v.data,null,2)),await _e(),v.data===!0){const d=[],b=(q.balance||0)-s;b>0&&d.push({type:"balance",value:b,label:u("dashboard.settings.rewards.balance")});const le=(((K=r.value)==null?void 0:K.transfer_enable)||0)-a;le>0&&d.push({type:"traffic",value:le,label:u("dashboard.settings.rewards.traffic")});const Me=(((W=r.value)==null?void 0:W.expired_at)||0)-i;Me>0&&d.push({type:"expire",value:Math.ceil(Me/86400),label:u("dashboard.settings.rewards.expire")}),((Q=r.value)==null?void 0:Q.plan_id)!==f&&d.push({type:"plan",label:u("dashboard.settings.rewards.plan")}),w.value=d.length>0?{rewards:d}:{success:!0}}else if(v.data.rewards&&typeof v.data.rewards=="object"&&!Array.isArray(v.data.rewards)){console.log("[ç¤¼å“å¡] æ£€æµ‹åˆ°XBoardçŽ°ä»£APIè¿”å›žæ ¼å¼ï¼ˆrewardsä¸ºå¯¹è±¡ï¼‰");const d=v.data.rewards,b=[];d.balance&&d.balance>0&&b.push({type:"balance",value:d.balance,label:u("dashboard.settings.rewards.balance")}),d.transfer_enable&&d.transfer_enable>0&&b.push({type:"traffic",value:d.transfer_enable,label:u("dashboard.settings.rewards.traffic")}),d.expire_days&&d.expire_days>0&&b.push({type:"expire",value:d.expire_days,label:u("dashboard.settings.rewards.expire")}),d.device_limit&&d.device_limit>0&&b.push({type:"device",value:d.device_limit,label:"è®¾å¤‡æ•°é‡"}),d.plan_id&&b.push({type:"plan",value:v.data.template_name||"è®¢é˜…å¥—é¤",label:u("dashboard.settings.rewards.plan")}),w.value={...v.data,rewards:b}}else if(v.data.data){console.log("[ç¤¼å“å¡] æ£€æµ‹åˆ°XBoardçŽ°ä»£APIè¿”å›žæ ¼å¼");const d=v.data.data.rewards||{},b=[];d.balance&&d.balance>0&&b.push({type:"balance",value:d.balance,label:u("dashboard.settings.rewards.balance")}),d.transfer_enable&&d.transfer_enable>0&&b.push({type:"traffic",value:d.transfer_enable,label:u("dashboard.settings.rewards.traffic")}),d.expire_days&&d.expire_days>0&&b.push({type:"expire",value:d.expire_days,label:u("dashboard.settings.rewards.expire")}),d.plan_id&&b.push({type:"plan",value:v.data.data.template_name||"è®¢é˜…å¥—é¤",label:u("dashboard.settings.rewards.plan")}),w.value={...v.data.data,rewards:b}}else w.value=v.data;console.log("[ç¤¼å“å¡] æœ€ç»ˆredeemRewardResult:",JSON.stringify(w.value,null,2)),L.success(u("dashboard.settings.redeemSuccess")),z.value=""}}catch(v){console.error("===== ç¤¼å“å¡å…‘æ¢é”™è¯¯è¯¦æƒ… ====="),console.error("é”™è¯¯å¯¹è±¡:",v),console.error("å“åº”çŠ¶æ€:",(X=v.response)==null?void 0:X.status),console.error("å“åº”æ•°æ®:",(Z=v.response)==null?void 0:Z.data),console.error("é”™è¯¯æ¶ˆæ¯:",v.message),console.error("============================");const d=((n=(Y=v.response)==null?void 0:Y.data)==null?void 0:n.message)||((y=(p=v.response)==null?void 0:p.data)==null?void 0:y.error),b={"The gift card has already been used by this user":u("dashboard.settings.giftCardUsedByUser"),"The gift card does not exist":u("dashboard.settings.giftCardNotFound"),"The gift card is not yet valid":u("dashboard.settings.giftCardNotValid"),"The gift card has expired":u("dashboard.settings.giftCardExpired"),"The gift card usage limit has been reached":u("dashboard.settings.giftCardUsedUp"),"Not suitable gift card type":"è¯¥ç¤¼å“å¡ç±»åž‹ä¸é€‚ç”¨äºŽæ‚¨å½“å‰çš„è®¢é˜…çŠ¶æ€","Unknown gift card type":"æœªçŸ¥çš„ç¤¼å“å¡ç±»åž‹"};b[d]?L.error(b[d]):L.error(d||u("common.error"))}finally{V.value=!1}},as=()=>{var s;(s=r.value)!=null&&s.subscribe_url&&(navigator.clipboard.writeText(r.value.subscribe_url),L.success(u("dashboard.home.copySuccess")))},U=s=>{var m;if(!((m=r.value)!=null&&m.subscribe_url)){L.warning(u("dashboard.home.linkNotReady"));return}const a=encodeURIComponent(r.value.subscribe_url),i=ie.siteName,f={clash:`clash://install-config?url=${a}&name=${encodeURIComponent(i)}`,shadowrocket:`shadowrocket://add/sub://${btoa(r.value.subscribe_url)}?remarks=${encodeURIComponent(i)}`,"quantumult-x":`quantumult-x:///add-resource?remote-resource=%7B%22server_remote%22:%5B%22${a},tag=${encodeURIComponent(i)}%22%5D%7D`,singbox:`sing-box://import-remote-profile?url=${a}#${encodeURIComponent(i)}`,surfboard:`surfboard:///install-config?url=${a}`,surge:`surge:///install-config?url=${a}`};f[s]&&(window.location.href=f[s],L.success(u("dashboard.home.jumpingToClient")))};return(s,a)=>{var G,K,W,Q,X,Z,Y;const i=ee("a-skeleton"),f=ee("BookOpen"),m=ee("a-modal"),O=ee("a-button"),j=ee("a-spin");return o(),l("div",Ts,[re.value||Se.value||fe.value||$e.value||Ne.value?(o(),l("div",As,[re.value?(o(),l("div",Is,[e("div",Bs,[h(c(ge),{size:20,class:"alert-icon"}),e("div",Ls,[e("span",Es,t(s.$t("dashboard.home.noSubscriptionTitle")),1),e("span",Ps,t(s.$t("dashboard.home.noSubscriptionDesc")),1)])]),e("button",{class:"alert-action",onClick:a[0]||(a[0]=n=>c(N).push("/plans"))},t(s.$t("dashboard.home.buyPlan")),1)])):Se.value?(o(),l("div",Js,[e("div",Us,[h(c(Ie),{size:20,class:"alert-icon"}),e("div",qs,[e("span",Hs,t(s.$t("dashboard.home.planExpiredTitle")),1),e("span",Vs,t(s.$t("dashboard.home.planExpiredDesc")),1)])]),e("button",{class:"alert-action",onClick:a[1]||(a[1]=n=>c(N).push("/plans"))},t(s.$t("dashboard.home.renewPlan")),1)])):fe.value?(o(),l("div",Fs,[e("div",js,[h(c(Ns),{size:20,class:"alert-icon"}),e("div",Gs,[e("span",Ks,t(s.$t("dashboard.home.trafficOutTitle")),1),e("span",Ws,t(s.$t("dashboard.home.trafficOutDesc")),1)])]),e("button",{class:"alert-action",onClick:a[2]||(a[2]=n=>c(N).push("/plans"))},t(s.$t("dashboard.home.resetTraffic")),1)])):$e.value?(o(),l("div",Qs,[e("div",Xs,[h(c(Ie),{size:20,class:"alert-icon"}),e("div",Zs,[e("span",Ys,t(s.$t("dashboard.home.expiringSoonTitle")),1),e("span",ea,t(s.$t("dashboard.home.expiringSoonDesc",{days:me.value})),1)])]),e("button",{class:"alert-action",onClick:a[3]||(a[3]=n=>c(N).push("/plans"))},t(s.$t("dashboard.home.renewPlan")),1)])):Ne.value?(o(),l("div",sa,[e("div",aa,[h(c($s),{size:20,class:"alert-icon"}),e("div",ta,[e("span",oa,t(s.$t("dashboard.home.trafficLowTitle")),1),e("span",ra,t(s.$t("dashboard.home.trafficLowDesc")),1)])]),e("button",{class:"alert-action",onClick:a[4]||(a[4]=n=>c(N).push("/plans"))},t(s.$t("dashboard.home.renewPlan")),1)])):S("",!0)])):S("",!0),e("div",la,[e("div",na,[a[23]||(a[23]=e("div",{class:"mesh-glow"},null,-1)),r.value?(o(),l("div",ia,[e("div",da,[e("div",ca,[e("span",ua,t(s.$t("dashboard.home.greeting",{name:((G=q.email)==null?void 0:G.split("@")[0])||"User"})),1),e("div",ha,[e("div",pa,[h(c(ys),{size:14}),e("span",null,t(((K=r.value.plan)==null?void 0:K.name)||s.$t("dashboard.home.noPlan")),1)]),c(ie).enableDailyCheckin?(o(),l("div",{key:0,class:ne(["checkin-badge-new",{checked:(W=x.value)==null?void 0:W.checked_in_today}]),onClick:Ze},[a[21]||(a[21]=e("div",{class:"shine-effect"},null,-1)),h(c(P),{size:14,class:"c-icon"}),e("span",va,t((Q=x.value)!=null&&Q.checked_in_today?s.$t("dashboard.home.alreadyCheckin"):s.$t("dashboard.home.checkinNow")),1)],2)):S("",!0),we.value?(o(),l("div",{key:1,class:"redeem-badge-new",onClick:a[5]||(a[5]=n=>he.value=!0)},[a[22]||(a[22]=e("div",{class:"shine-effect"},null,-1)),h(c(ye),{size:14,class:"c-icon"}),e("span",ma,t(s.$t("dashboard.settings.redeemGiftCard")),1)])):S("",!0)])])]),e("div",fa,[e("div",_a,[e("div",ba,[h(c(P),{size:18,class:"text-accent-purple"}),e("span",ya,t(s.$t("dashboard.home.expireTime")),1)]),e("span",ga,t(qe.value),1),r.value.expired_at?(o(),l("div",ka,[e("span",wa,t(new Date(r.value.expired_at*1e3).toLocaleDateString()),1)])):S("",!0)]),e("div",Ca,[e("div",Sa,[h(c(ks),{size:18,class:"text-accent-blue"}),e("span",$a,t(s.$t("dashboard.home.resetTime")),1)]),e("span",Na,t(He.value),1),Re.value?(o(),l("div",xa,[e("span",Ra,t(Re.value)+" | "+t(ze.value),1)])):(o(),l("div",za,[e("span",Da,t(ze.value),1)]))]),e("div",Ma,[e("div",Oa,[h(c(ae),{size:18,class:"text-primary"}),e("span",Ta,t(s.$t("dashboard.home.remainingTraffic")),1)]),e("span",Aa,t(xe(r.value.transfer_enable-(r.value.u+r.value.d))),1),e("div",Ia,[e("span",Ba,t(s.$t("dashboard.home.availableQuota")),1)])])])])):de.value&&!r.value?(o(),l("div",La,[h(i,{active:"",paragraph:{rows:3}})])):(o(),l("div",Ea,[e("span",null,t(s.$t("dashboard.home.noDataAvailable")),1)]))]),e("div",Pa,[e("div",Ja,[h(c(Ee),{size:18}),e("h3",null,t(s.$t("dashboard.home.importantNotices")),1)]),I.value.length>0?(o(),l("div",Ua,[(o(!0),l(T,null,se(I.value,n=>(o(),l("div",{class:"notice-item",key:n.id,onClick:p=>Fe(n)},[a[24]||(a[24]=e("div",{class:"n-icon"},"ðŸ“Œ",-1)),e("div",Ha,[e("span",Va,t(n.title),1),e("span",Fa,t(new Date(n.created_at*1e3).toLocaleDateString()),1)]),h(c(gs),{size:16,class:"n-arrow"})],8,qa))),128))])):(o(),l("div",ja,[e("span",null,t(s.$t("dashboard.home.noNotices")),1)]))]),e("div",Ga,[e("div",Ka,[e("div",Wa,[e("div",Qa,[e("h4",null,t(s.$t("dashboard.home.subscribeLink")),1),e("div",Xa,[e("input",{readonly:"",value:((X=r.value)==null?void 0:X.subscribe_url)||"https://link.example.com/...",class:"link-input"},null,8,Za),e("button",{onClick:as,class:"copy-btn"},[h(c(ws),{size:16})])])]),e("div",Ya,[e("h4",null,t(s.$t("dashboard.home.oneClickImport")),1),e("div",et,[e("div",{class:"import-item",onClick:a[6]||(a[6]=n=>U("clash"))},[...a[25]||(a[25]=[e("div",{class:"q-icon",title:"Clash"},[e("img",{src:xs,alt:"Clash"})],-1),e("span",null,"Clash",-1)])]),e("div",{class:"import-item",onClick:a[7]||(a[7]=n=>U("shadowrocket"))},[...a[26]||(a[26]=[e("div",{class:"q-icon",title:"Shadowrocket"},[e("img",{src:Rs,alt:"Shadowrocket"})],-1),e("span",null,"Shadowrocket",-1)])]),e("div",{class:"import-item",onClick:a[8]||(a[8]=n=>U("singbox"))},[...a[27]||(a[27]=[e("div",{class:"q-icon",title:"Singbox"},[e("img",{src:zs,alt:"Singbox"})],-1),e("span",null,"Singbox",-1)])]),e("div",{class:"import-item",onClick:a[9]||(a[9]=n=>U("surfboard"))},[...a[28]||(a[28]=[e("div",{class:"q-icon",title:"Surfboard"},[e("img",{src:Ds,alt:"Surfboard"})],-1),e("span",null,"Surfboard",-1)])]),e("div",{class:"import-item",onClick:a[10]||(a[10]=n=>U("surge"))},[...a[29]||(a[29]=[e("div",{class:"q-icon",title:"Surge"},[e("img",{src:Ms,alt:"Surge"})],-1),e("span",null,"Surge",-1)])]),e("div",{class:"import-item",onClick:a[11]||(a[11]=n=>U("quantumult-x"))},[...a[30]||(a[30]=[e("div",{class:"q-icon",title:"Quantumult X"},[e("img",{src:Os,alt:"Quantumult X"})],-1),e("span",null,"Quantumult X",-1)])]),e("div",st,[h(c(Pe),{value:((Z=r.value)==null?void 0:Z.subscribe_url)||"https://xboard.link/placeholder",size:88,color:(ke.value,"#1E293B"),"bg-color":ke.value?"#FFFFFF":"transparent",status:(Y=r.value)!=null&&Y.subscribe_url?"active":"loading"},null,8,["value","color","bg-color","status"]),e("p",null,t(s.$t("dashboard.home.scanToImport")),1)])])])]),e("div",at,[e("h4",null,t(s.$t("dashboard.home.clientDownload")),1),e("div",tt,[(o(!0),l(T,null,se(te.value,(n,p)=>(o(),l("div",{key:p,class:"platform-group"},[(o(!0),l(T,null,se(n.clients,y=>(o(),l("div",{key:y.name,class:"client-item-row"},[e("a",{href:y.url,target:"_blank",class:"download-link"},[e("img",{src:y.icon,alt:y.name},null,8,rt),e("div",lt,[e("span",nt,t(y.name),1),e("span",it,t(y.platform),1)])],8,ot),e("a",{onClick:v=>We(y),class:"doc-btn-small"},[h(f,{size:18}),e("span",null,t(s.$t("dashboard.home.usageDocs")),1)],8,dt)]))),128))]))),128))])])])])]),h(m,{open:H.value,"onUpdate:open":a[13]||(a[13]=n=>H.value=n),footer:null,width:650,class:"notice-modal",centered:""},{title:D(()=>{var n;return[e("div",ct,[e("div",ut,[h(c(Ee),{size:18})]),e("span",ht,t((n=k.value)==null?void 0:n.title),1)])]}),default:D(()=>{var n;return[a[31]||(a[31]=e("div",{class:"modal-mesh"},null,-1)),C.value?(o(),l("div",{key:0,class:ne(["promo-card-wrapper",C.value.theme||"default"])},[e("div",pt,[e("div",vt,[e("h2",{class:"promo-title",innerHTML:(n=C.value.title)==null?void 0:n.replace(/\\n/g,"<br>")},null,8,mt)]),e("div",ft,[e("p",_t,t(C.value.content),1),C.value.code?(o(),l("div",bt,[e("span",yt,t(s.$t("dashboard.home.recommendCode")),1),e("span",gt,t(C.value.code),1)])):S("",!0)]),C.value.btnText?(o(),l("div",kt,[e("button",{class:"promo-btn",onClick:a[12]||(a[12]=p=>je(C.value.btnRoute))},t(C.value.btnText),1)])):S("",!0)])],2)):(o(),l("div",{key:1,class:"notice-detail-content markdown-body",innerHTML:Ve.value},null,8,wt)),e("div",Ct,[e("div",St,[h(c(P),{size:12}),e("span",null,t(k.value?new Date(k.value.created_at*1e3).toLocaleString():""),1)])])]}),_:1},8,["open"]),h(m,{open:ce.value,"onUpdate:open":a[14]||(a[14]=n=>ce.value=n),footer:null,width:420,class:"checkin-modal",centered:""},{default:D(()=>{var n,p,y;return[e("div",$t,[e("div",Nt,[e("div",xt,[a[32]||(a[32]=e("div",{class:"ripple"},null,-1)),h(c(P),{size:48,class:"main-icon"})]),e("h2",Rt,t((n=x.value)!=null&&n.checked_in_today?s.$t("dashboard.home.checkinSuccess"):s.$t("dashboard.home.dailyCheckin")),1),e("p",zt,t(s.$t("dashboard.home.checkinRulesDesc")),1)]),e("div",Dt,[e("div",Mt,[e("span",Ot,t(((p=x.value)==null?void 0:p.streak_days)||0),1),e("span",Tt,t(s.$t("dashboard.home.consecutiveDays")),1)])]),R.value?(o(),l("div",At,[e("div",It,[R.value.type==="traffic"?(o(),$(c(ae),{key:0,size:24,class:"reward-icon traffic"})):(o(),$(c(P),{key:1,size:24,class:"reward-icon days"})),e("div",Bt,[e("span",Lt,t(R.value.type==="traffic"?s.$t("dashboard.home.trafficReward"):s.$t("dashboard.home.dayReward")),1),e("span",Et,"+"+t(R.value.value)+" "+t(R.value.unit),1)])])])):S("",!0),e("div",Pt,[h(O,{type:"primary",block:"",size:"large",class:"do-checkin-btn",loading:ue.value,disabled:(y=x.value)==null?void 0:y.checked_in_today,onClick:Ye},{default:D(()=>{var v;return[E(t((v=x.value)!=null&&v.checked_in_today?s.$t("dashboard.home.alreadyCheckin"):s.$t("dashboard.home.checkinNow")),1)]}),_:1},8,["loading","disabled"])])])]}),_:1},8,["open"]),h(m,{open:he.value,"onUpdate:open":a[19]||(a[19]=n=>he.value=n),footer:null,width:460,class:"redeem-modal",centered:""},{default:D(()=>{var n;return[e("div",Jt,[e("div",Ut,[e("div",{class:ne(["tab-item",{active:B.value==="redeem"}]),onClick:a[15]||(a[15]=p=>B.value="redeem")},[h(c(ye),{size:16}),e("span",null,t(s.$t("dashboard.settings.redeem")),1)],2),M.value?(o(),l("div",{key:0,class:ne(["tab-item",{active:B.value==="history"}]),onClick:a[16]||(a[16]=p=>{B.value="history",ss()})},[h(c(Ss),{size:16}),e("span",null,t(s.$t("dashboard.settings.history")),1)],2)):S("",!0)]),B.value==="redeem"?(o(),l("div",qt,[e("div",Ht,[e("div",Vt,[a[33]||(a[33]=e("div",{class:"ripple"},null,-1)),h(c(ye),{size:48,class:"main-icon"})]),w.value?(o(),l("h2",jt,t(s.$t("dashboard.settings.redeemSuccess")),1)):(o(),l("h2",Ft,t(s.$t("dashboard.settings.redeemGiftCard")),1))]),w.value?(o(),l("div",Xt,[e("div",Zt,[h(c(Cs),{size:20}),a[34]||(a[34]=e("span",null,"OK",-1))]),e("p",Yt,t(s.$t("dashboard.settings.redeemSuccess")),1),e("div",eo,[(n=w.value)!=null&&n.rewards?(o(!0),l(T,{key:0},se(w.value.rewards,(p,y)=>(o(),l("div",{key:y,class:"reward-item-simple"},[p.type==="balance"?(o(),$(c(Be),{key:0,size:16,class:"text-accent-blue"})):p.type==="traffic"?(o(),$(c(ae),{key:1,size:16,class:"text-accent-blue"})):p.type==="expire"?(o(),$(c(P),{key:2,size:16,class:"text-accent-blue"})):(o(),$(c(ge),{key:3,size:16,class:"text-accent-blue"})),e("span",so,[p.type==="balance"?(o(),l(T,{key:0},[E("Â¥"+t(p.value/100),1)],64)):p.type==="traffic"?(o(),l(T,{key:1},[E(t(xe(p.value)),1)],64)):p.type==="expire"?(o(),l(T,{key:2},[E(t(p.value)+t(s.$t("dashboard.home.daysLaterResetShort")),1)],64)):S("",!0),E(" "+t(p.label),1)])]))),128)):(o(),l("div",ao,[h(c(ae),{size:16}),e("span",null,t(s.$t("dashboard.settings.redeemSuccess")),1)]))]),h(O,{block:"",type:"primary",onClick:a[18]||(a[18]=p=>{w.value=null,z.value=""}),class:"close-result-btn"},{default:D(()=>[E(t(s.$t("common.confirm")),1)]),_:1})])):(o(),l("div",Gt,[e("div",Kt,[is(e("input",{"onUpdate:modelValue":a[17]||(a[17]=p=>z.value=p),type:"text",placeholder:s.$t("dashboard.settings.giftCardPlaceholder"),class:"redeem-input",disabled:V.value,onKeyup:ds(De,["enter"])},null,40,Wt),[[cs,z.value]])]),e("div",Qt,[h(O,{type:"primary",block:"",size:"large",class:"do-redeem-btn",loading:V.value,disabled:!z.value,onClick:De},{default:D(()=>[E(t(V.value?s.$t("dashboard.settings.redeeming"):s.$t("dashboard.settings.redeemBtn")),1)]),_:1},8,["loading","disabled"])])]))])):(o(),l("div",to,[pe.value?(o(),l("div",oo,[h(j)])):M.value?oe.value.length===0?(o(),l("div",lo,[h(c(Le),{size:40}),e("p",null,t(s.$t("dashboard.settings.noHistory")),1)])):(o(),l("div",no,[(o(!0),l(T,null,se(oe.value,p=>(o(),l("div",{key:p.id,class:"history-item glass-card"},[e("div",io,[p.template_type==="balance"?(o(),$(c(Be),{key:0,size:18})):p.template_type==="traffic"?(o(),$(c(ae),{key:1,size:18})):p.template_type==="expire"?(o(),$(c(P),{key:2,size:18})):(o(),$(c(ge),{key:3,size:18}))]),e("div",co,[e("div",uo,[e("span",ho,t(p.template_name),1),e("span",po,t(new Date(p.created_at*1e3).toLocaleDateString()),1)]),e("div",vo,[e("span",mo,t(p.code),1)])])]))),128))])):(o(),l("div",ro,[h(c(Le),{size:40}),e("p",null,t(s.$t("dashboard.settings.notSupported")),1)]))]))])]}),_:1},8,["open"]),h(m,{open:F.value,"onUpdate:open":a[20]||(a[20]=n=>F.value=n),footer:null,width:800,centered:"",class:"knowledge-modal"},{title:D(()=>{var n;return[e("div",fo,[h(f,{size:20}),e("span",null,t((n=J.value)==null?void 0:n.title),1)])]}),default:D(()=>[ve.value?(o(),l("div",_o,[h(j)])):(o(),l("div",{key:1,class:"modal-content markdown-body",innerHTML:Qe.value},null,8,bo))]),_:1},8,["open"])])}}}),Ao=bs(go,[["__scopeId","data-v-81e15ee6"]]);export{Ao as default};
