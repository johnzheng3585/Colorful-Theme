import{u as z,r as w,a as A,k as F,c as b,b as s,d as p,g as I,t as l,e as o,w as i,f as m,h as V,o as g,l as T,m as j,i as y,j as f}from"./index.js";import{g as x,s as M,r as P}from"./auth.js";import{_ as D}from"./_plugin-vue_export-helper.js";const G={class:"dark-tech-auth"},L={class:"auth-grid"},H={class:"branding-side"},J={class:"brand-content"},K={class:"logo-container"},O=["src","alt"],Q={key:1,class:"brand-title"},W={class:"brand-desc"},X={class:"features"},Y={class:"feature-badge"},Z={class:"feature-badge"},ee={class:"form-side"},ae={class:"glass-card form-container"},se={class:"form-header"},te={class:"code-input-group"},oe={class:"form-footer"},le={href:"#/login",class:"link-primary"},re={__name:"Register",setup(ie){const{t:n}=z(),_=I(),C=V(),v=w(!1),u=w({}),t=A({email:"",password:"",re_password:"",email_code:"",agreement:!0}),c=w(0);let k=null;const R=async()=>{if(!t.email)return f.error(n("validation.emailRequired"));try{await M({email:t.email}),f.success(n("auth.codeSent")),c.value=60,k=setInterval(()=>{c.value--,c.value<=0&&clearInterval(k)},1e3)}catch(e){f.error(e.message||n("auth.sendFailed"))}};F(async()=>{try{const e=await x();e.data&&(u.value=e.data)}catch(e){console.error("Failed to fetch config:",e)}});const E=async(e,a)=>{if(!a)throw new Error("è¯·æŽ¥å—æœåŠ¡æ¡æ¬¾")},N=async(e,a)=>{if(!a)throw new Error("è¯·è¾“å…¥é‚®ç®±");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))throw new Error(n("validation.emailInvalid"));if(u.value.email_whitelist_suffix&&Array.isArray(u.value.email_whitelist_suffix)){const d=a.split("@")[1];if(!u.value.email_whitelist_suffix.includes(d))throw new Error(n("validation.emailSuffixNotAllowed",{suffixes:u.value.email_whitelist_suffix.join(", ")}))}},U=async e=>{if(e.password!==e.re_password)return f.error(n("validation.passwordMismatch"));v.value=!0;try{(await P(e)).data&&(f.success(n("auth.registerSuccess")),C.push("/login"))}catch{f.error(n("auth.registerFailed"))}finally{v.value=!1}};return(e,a)=>{const h=m("a-input"),d=m("a-form-item"),$=m("a-button"),S=m("a-input-password"),q=m("a-checkbox"),B=m("a-form");return g(),b("div",G,[s("div",L,[s("div",H,[s("div",J,[s("div",K,[a[5]||(a[5]=s("div",{class:"logo-glow"},null,-1)),p(_).logoUrl?(g(),b("img",{key:0,src:p(_).logoUrl,alt:p(_).siteName,class:"brand-logo-image"},null,8,O)):(g(),b("h1",Q,"åŠ å…¥ "+l(p(_).siteName),1))]),s("p",W,l(e.$t("auth.registerSubtitle")),1),s("div",X,[s("div",Y,[a[6]||(a[6]=s("div",{class:"badge-icon"},"ðŸ›¡ï¸",-1)),s("span",null,l(e.$t("auth.privacyProtection")),1)]),s("div",Z,[a[7]||(a[7]=s("div",{class:"badge-icon"},"âš¡",-1)),s("span",null,l(e.$t("auth.unlimitedTraffic")),1)])])])]),s("div",ee,[s("div",ae,[s("div",se,[s("h2",null,l(e.$t("auth.registerButton")),1),s("p",null,l(e.$t("auth.registerSubtitle")),1)]),o(B,{model:t,onFinish:U,layout:"vertical"},{default:i(()=>[o(d,{label:e.$t("auth.email"),name:"email",rules:[{validator:N}]},{default:i(()=>[o(h,{value:t.email,"onUpdate:value":a[0]||(a[0]=r=>t.email=r),placeholder:"your@email.com",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),u.value.is_email_verify?(g(),T(d,{key:0,label:"é‚®ç®±éªŒè¯ç ",name:"email_code",rules:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±éªŒè¯ç "}],class:"code-item"},{default:i(()=>[s("div",te,[o(h,{value:t.email_code,"onUpdate:value":a[1]||(a[1]=r=>t.email_code=r),placeholder:"è¾“å…¥éªŒè¯ç ",size:"large"},null,8,["value"]),o($,{type:"primary",class:"send-code-btn",disabled:c.value>0||!t.email,onClick:R},{default:i(()=>[y(l(c.value>0?`${c.value}s`:"å‘é€éªŒè¯ç "),1)]),_:1},8,["disabled"])])]),_:1})):j("",!0),o(d,{label:e.$t("auth.password"),name:"password",rules:[{required:!0,message:e.$t("validation.passwordRequired")}]},{default:i(()=>[o(S,{value:t.password,"onUpdate:value":a[2]||(a[2]=r=>t.password=r),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),o(d,{label:e.$t("auth.confirmPassword"),name:"re_password",rules:[{required:!0,message:e.$t("validation.passwordRequired")}]},{default:i(()=>[o(S,{value:t.re_password,"onUpdate:value":a[3]||(a[3]=r=>t.re_password=r),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),o(d,{name:"agreement",rules:[{validator:E}]},{default:i(()=>[o(q,{checked:t.agreement,"onUpdate:checked":a[4]||(a[4]=r=>t.agreement=r)},{default:i(()=>[y(l(e.$t("auth.agreement")),1)]),_:1},8,["checked"])]),_:1},8,["rules"]),o($,{type:"primary","html-type":"submit",loading:v.value,block:"",size:"large"},{default:i(()=>[y(l(e.$t("auth.registerButton")),1)]),_:1},8,["loading"])]),_:1},8,["model"]),s("div",oe,[s("span",null,l(e.$t("auth.hasAccount")),1),s("a",le,l(e.$t("auth.backToLogin")),1)])])])])])}}},ce=D(re,[["__scopeId","data-v-53af7c3c"]]);export{ce as default};
