import{u as S,r as _,o as q,m as P,a as F,c as r,b as a,k as y,e as d,d as i,t as o,F as p,x as b,f as O,h as R,i as l,y as g}from"./index.js";import{f as A,s as E}from"./user.js";import{_ as V}from"./_plugin-vue_export-helper.js";import{Z as $}from"./zap.js";import{C as H}from"./circle-check-big.js";import{R as J}from"./refresh-cw.js";import{A as T}from"./arrow-right.js";import"./createLucideIcon.js";const Z={class:"dark-tech-plans animate-fade-in"},j={class:"page-header"},x={class:"header-icon"},D={key:0,class:"plans-grid"},G={key:0,class:"featured-badge"},K={class:"plan-header"},Q={class:"plan-name"},U={class:"plan-cycle-selector"},W=["onClick"],X={class:"plan-price"},Y={class:"amount"},ee={class:"period"},se={class:"plan-features"},ae=["innerHTML"],te={class:"plan-footer"},re=["onClick","disabled"],le={key:1,class:"loading-state"},ce={key:2,class:"empty-state"},oe={__name:"Plans",setup(ne){const z=R(),{t:C}=S();_([]);const u=_(!0),h=_(!1),v=_(null),f={month_price:{label:"dashboard.plans.cycles.month_price",value:"month_price"},quarter_price:{label:"dashboard.plans.cycles.quarter_price",value:"quarter_price"},half_year_price:{label:"dashboard.plans.cycles.half_year_price",value:"half_year_price"},year_price:{label:"dashboard.plans.cycles.year_price",value:"year_price"},two_year_price:{label:"dashboard.plans.cycles.two_year_price",value:"two_year_price"},three_year_price:{label:"dashboard.plans.cycles.three_year_price",value:"three_year_price"},onetime_price:{label:"dashboard.plans.cycles.onetime_price",value:"onetime_price"},reset_price:{label:"dashboard.plans.cycles.reset_price",value:"reset_price"}},m=_([]);q(()=>{M(),B()});const M=()=>{try{const e=localStorage.getItem("xboard_plan_list");e&&(k(JSON.parse(e)),u.value=!1)}catch(e){console.error("Plans cache load error:",e)}},B=async()=>{try{const e=await A();e.data&&(k(e.data),localStorage.setItem("xboard_plan_list",JSON.stringify(e.data)))}catch{P.error("åŠ è½½å¥—é¤å¤±è´¥")}finally{u.value=!1}},k=e=>{const t=new Map;e.forEach(n=>{if(!t.has(n.id)){const s=[];Object.keys(f).forEach(c=>{n[c]!==null&&n[c]!==void 0&&s.push(f[c])}),t.set(n.id,F({...n,availableCycles:s,selectedCycle:s.length>0?s[0].value:null}))}}),m.value=Array.from(t.values())},I=e=>e.selectedCycle?(e[e.selectedCycle]/100).toFixed(2):"0.00",L=e=>{var t;return((t=f[e])==null?void 0:t.label)||""},N=async e=>{if(e.selectedCycle){h.value=!0,v.value=e.id;try{const t=await E({plan_id:e.id,period:e.selectedCycle});t.data&&(P.success("è®¢å•å·²åˆ›å»º"),z.push({path:"/order",query:{trade_no:t.data}}))}catch{}finally{h.value=!1,v.value=null}}};return(e,t)=>{const n=O("a-spin");return l(),r("div",Z,[a("div",j,[a("div",x,[d(i($),{size:32})]),a("h1",null,o(e.$t("dashboard.plans.title")),1),a("p",null,o(e.$t("dashboard.plans.description")),1)]),u.value?y("",!0):(l(),r("div",D,[(l(!0),r(p,null,b(m.value,s=>(l(),r("div",{key:s.id,class:g(["plan-card glass-card",{featured:s.show}])},[s.show?(l(),r("div",G,[d(i($),{size:12}),a("span",null,o(e.$t("dashboard.plans.featured")),1)])):y("",!0),a("div",K,[a("h3",Q,o(s.name),1),a("div",U,[(l(!0),r(p,null,b(s.availableCycles,c=>(l(),r("div",{key:c.value,class:g(["cycle-btn",{active:s.selectedCycle===c.value}]),onClick:w=>s.selectedCycle=c.value},o(i(C)(c.label)),11,W))),128))]),a("div",X,[t[0]||(t[0]=a("span",{class:"currency"},"Â¥",-1)),a("span",Y,o(I(s)),1),a("span",ee,"/ "+o(i(C)(L(s.selectedCycle))),1)])]),a("div",se,[(s.content||"").includes("<div")?(l(),r("div",{key:0,class:"plan-features-html",innerHTML:s.content},null,8,ae)):(l(!0),r(p,{key:1},b((s.content||"").split(`
`),(c,w)=>(l(),r("div",{class:"feature-item",key:w},[d(i(H),{size:16,class:"check-icon"}),a("span",null,o(c),1)]))),128))]),a("div",te,[a("button",{class:g(["buy-btn",{featured:s.show}]),onClick:c=>N(s),disabled:h.value},[h.value&&v.value===s.id?(l(),r(p,{key:0},[d(i(J),{class:"animate-spin",size:18}),a("span",null,o(e.$t("dashboard.plans.processing")),1)],64)):(l(),r(p,{key:1},[a("span",null,o(e.$t("dashboard.plans.subscribe")),1),d(i(T),{size:18})],64))],10,re)])],2))),128))])),u.value?(l(),r("div",le,[d(n,{size:"large"})])):y("",!0),!u.value&&m.value.length===0?(l(),r("div",ce,[t[1]||(t[1]=a("div",{class:"empty-icon"},"ðŸ“‚",-1)),a("p",null,o(e.$t("dashboard.plans.noPlans")),1)])):y("",!0)])}}},fe=V(oe,[["__scopeId","data-v-d338e253"]]);export{fe as default};
