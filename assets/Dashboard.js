import{A as Z,u as ds,s as us,n as R,r as h,a as hs,o as ms,g as vs,c as l,b as s,e as c,t as a,k as w,d,y as X,f as J,F as T,x as L,w as N,m as D,h as ps,i as n,j as H,l as _s}from"./index.js";import{a as bs,g as gs,b as fs,c as ks,d as ws}from"./user.js";import{d as E,C as y,a as ys}from"./marked.esm.js";import{_ as Ss}from"./_plugin-vue_export-helper.js";import{A as Cs}from"./activity.js";import{R as $s}from"./refresh-cw.js";import{Z as G}from"./zap.js";import{c as xs}from"./createLucideIcon.js";import{C as Ns}from"./copy.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=xs("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),Ds={class:"dark-tech-dashboard"},Os={class:"bento-grid"},Is={class:"subscription-hero glass-card bento-item lg:col-span-8"},zs={key:0,class:"hero-content"},Rs={class:"user-meta"},Js={class:"user-titles"},Ts={class:"greeting"},Ls={class:"user-info-row"},Ms={class:"plan-tag"},Bs={class:"c-text"},qs={class:"metric-grid"},As={class:"metric-item glass-card"},js={class:"m-header"},Vs={class:"m-label"},Fs={class:"m-value"},Qs={key:0,class:"m-footer"},Us={class:"m-subtext"},Ws={class:"metric-item glass-card"},Xs={class:"m-header"},Hs={class:"m-label"},Es={class:"m-value"},Gs={class:"m-footer"},Ps={class:"m-subtext"},Zs={class:"metric-item glass-card highlight"},Ks={class:"m-header"},Ys={class:"m-label"},se={class:"m-value text-primary"},ee={class:"m-footer"},te={class:"m-subtext"},ae={key:1,class:"hero-skeleton-wrap"},oe={key:2,class:"hero-empty-state"},ie={class:"notification-wall glass-card bento-item lg:col-span-4"},ne={class:"card-header"},le={key:0,class:"notice-list"},re=["onClick"],ce={class:"n-body"},de={class:"n-title"},ue={class:"n-time"},he={key:1,class:"notice-empty"},me={class:"subscribe-section glass-card bento-item lg:col-span-12"},ve={class:"sub-layout"},pe={class:"sub-left"},_e={class:"sub-section"},be={class:"link-input-group"},ge=["value"],fe={class:"sub-section"},ke={class:"quick-icons"},we={class:"qr-code-box"},ye={class:"sub-right"},Se={class:"client-downloads"},Ce=["href"],$e=["src","alt"],xe={class:"dl-info"},Ne={class:"dl-name"},De={class:"dl-platform"},Oe={class:"modal-title-custom"},Ie={class:"title-icon"},ze={class:"title-text"},Re={class:"promo-card"},Je={class:"promo-header"},Te=["innerHTML"],Le={class:"promo-body"},Me={class:"promo-desc"},Be={key:0,class:"promo-code-box"},qe={class:"code-label"},Ae={class:"code-val"},je={key:0,class:"promo-action"},Ve=["innerHTML"],Fe={class:"notice-detail-footer"},Qe={class:"info-badge"},Ue={class:"checkin-modal-content"},We={class:"checkin-header"},Xe={class:"checkin-icon-wrap"},He={class:"checkin-title"},Ee={class:"checkin-subtitle"},Ge={class:"checkin-stats"},Pe={class:"stat-card"},Ze={class:"stat-val"},Ke={class:"stat-lab"},Ye={key:0,class:"reward-box animate-bounce-in"},st={class:"reward-content"},et={class:"reward-info"},tt={class:"reward-label"},at={class:"reward-value"},ot={class:"checkin-actions"},it={components:{AQrcode:Z}},nt=Object.assign(it,{__name:"Dashboard",setup(lt){E.setOptions({breaks:!0,gfm:!0,headerIds:!0,mangle:!1});const K=ps(),{t:b}=ds(),Y=us(),ss=R(()=>Y.theme==="dark"),M=vs(),i=h(JSON.parse(localStorage.getItem("xboard_subscribe_info")||"null")),S=hs(JSON.parse(localStorage.getItem("xboard_user_info")||'{"email":""}')),C=h({}),$=h(JSON.parse(localStorage.getItem("xboard_notices")||"[]")),m=h(null),x=h(!1),O=h(!1),v=h(null),I=h(!1),z=h(!1),p=h(null),u=R(()=>{var e;if(!((e=m.value)!=null&&e.content))return null;try{const t=m.value.content.trim();if(t.startsWith("{")&&t.endsWith("}")){const r=JSON.parse(t);if(r&&r.cardComponent)return r}}catch{}return null}),es=R(()=>{var e;if(!((e=m.value)!=null&&e.content)||u.value)return"";try{return E.parse(m.value.content)}catch(t){return console.error("Markdown parsing error:",t),m.value.content}}),ts=e=>{m.value=e,x.value=!0},as=e=>{e&&(e.startsWith("http")?window.open(e,"_blank"):(K.push(e),x.value=!1))};ms(async()=>{i.value||(O.value=!0),await B(),M.enableDailyCheckin&&await os(),O.value=!1;try{const e=localStorage.getItem("xboard_client_config");e&&(C.value=JSON.parse(e));const r=await(await fetch("/clientConfig.json")).json();r.downloads&&(C.value=r.downloads,localStorage.setItem("xboard_client_config",JSON.stringify(r.downloads)))}catch{C.value={windows_android:{title:"Windows / Android",clients:[{name:"Clash Verge",platform:"Windows",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Clash.9gwri62wr1.webp",url:"https://clashverge.dev/"},{name:"Surfboard",platform:"Android",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Surfboard.8vn3vv8ggg.svg",url:"https://manual.getsurfboard.com/"}]},macos_ios:{title:"macOS / iOS",clients:[{name:"Clash Verge",platform:"macOS",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Clash.9gwri62wr1.webp",url:"https://clashverge.dev/"},{name:"Shadowrocket",platform:"iOS",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Shadowrocket.8z6ptl1j67.webp",url:"https://apps.apple.com/app/shadowrocket/id932747118"}]}}}});const B=async()=>{try{const[e,t,r]=await Promise.all([bs(),gs(),fs()]);e.data&&JSON.stringify(e.data)!==JSON.stringify(i.value)&&(i.value=e.data,localStorage.setItem("xboard_subscribe_info",JSON.stringify(e.data))),t.data&&JSON.stringify(t.data)!==JSON.stringify(S)&&(Object.assign(S,t.data),localStorage.setItem("xboard_user_info",JSON.stringify(t.data))),r.data&&JSON.stringify(r.data)!==JSON.stringify($.value)&&($.value=r.data,localStorage.setItem("xboard_notices",JSON.stringify(r.data)))}catch{}},os=async()=>{try{const e=await ks();e.data&&(v.value=e.data,e.data.checked_in_today&&(e.data.reward_type==="traffic"?p.value={type:"traffic",value:e.data.reward_traffic,unit:"MB"}:e.data.reward_type==="days"&&(p.value={type:"days",value:e.data.reward_days,unit:b("dashboard.home.checkinDays")})))}catch(e){console.error("Fetch checkin status error:",e)}},is=()=>{I.value=!0},ns=async()=>{var e;if(!((e=v.value)!=null&&e.checked_in_today)){z.value=!0;try{const t=await ws();t.data&&(v.value={checked_in_today:!0,streak_days:t.data.streak_days,reward_type:t.data.reward_type,reward_traffic:t.data.reward_traffic,reward_days:t.data.reward_days},t.data.reward_type==="traffic"?p.value={type:"traffic",value:t.data.reward_traffic,unit:"MB"}:p.value={type:"days",value:t.data.reward_days,unit:b("dashboard.home.checkinDays")},D.success(b("dashboard.home.checkinSuccess")),await B())}catch{}finally{z.value=!1}}},ls=e=>!e||e<=0?"0 GB":(e/1024**3).toFixed(2)+" GB",rs=()=>{var e;(e=i.value)!=null&&e.subscribe_url&&(navigator.clipboard.writeText(i.value.subscribe_url),D.success(b("dashboard.home.copySuccess")))},g=e=>{var k;if(!((k=i.value)!=null&&k.subscribe_url)){D.warning(b("dashboard.home.linkNotReady"));return}const t=encodeURIComponent(i.value.subscribe_url),r={clash:`clash://install-config?url=${t}`,shadowrocket:`shadowrocket://add/sub://${btoa(i.value.subscribe_url)}?remarks=${encodeURIComponent(S.email||"Xboard")}`,"quantumult-x":`quantumult-x:///add-resource?remote-resource=%7B%22server_remote%22:%5B%22${t},tag=Xboard%22%5D%7D`,singbox:`sing-box://import-remote-profile?url=${t}`,surfboard:`surfboard:///install-config?url=${t}`,surge:`surge:///install-config?url=${t}`};r[e]&&(window.location.href=r[e],D.success(b("dashboard.home.jumpingToClient")))};return(e,t)=>{var q,A,j,V,F,Q,U;const r=J("a-skeleton"),k=J("a-modal"),cs=J("a-button");return n(),l("div",Ds,[s("div",Os,[s("div",Is,[t[10]||(t[10]=s("div",{class:"mesh-glow"},null,-1)),i.value?(n(),l("div",zs,[s("div",Rs,[s("div",Js,[s("span",Ts,a(e.$t("dashboard.home.greeting",{name:((q=S.email)==null?void 0:q.split("@")[0])||"User"})),1),s("div",Ls,[s("div",Ms,[c(d(Cs),{size:14}),s("span",null,a(((A=i.value.plan)==null?void 0:A.name)||e.$t("dashboard.home.noPlan")),1)]),d(M).enableDailyCheckin?(n(),l("div",{key:0,class:X(["checkin-badge-new",{checked:(j=v.value)==null?void 0:j.checked_in_today}]),onClick:is},[t[9]||(t[9]=s("div",{class:"shine-effect"},null,-1)),c(d(y),{size:14,class:"c-icon"}),s("span",Bs,a((V=v.value)!=null&&V.checked_in_today?e.$t("dashboard.home.alreadyCheckin"):e.$t("dashboard.home.checkinNow")),1)],2)):w("",!0)])])]),s("div",qs,[s("div",As,[s("div",js,[c(d(y),{size:18,class:"text-accent-purple"}),s("span",Vs,a(e.$t("dashboard.home.expireTime")),1)]),s("span",Fs,a(i.value.expired_at?new Date(i.value.expired_at*1e3).toLocaleDateString():e.$t("dashboard.home.forever")),1),i.value.expired_at?(n(),l("div",Qs,[s("span",Us,a(Math.ceil((i.value.expired_at-Date.now()/1e3)/(24*3600)))+" "+a(e.$t("dashboard.home.daysLaterReset")),1)])):w("",!0)]),s("div",Ws,[s("div",Xs,[c(d($s),{size:18,class:"text-accent-blue"}),s("span",Hs,a(e.$t("dashboard.home.resetTime")),1)]),s("span",Es,a(e.$t("dashboard.home.resetDate")),1),s("div",Gs,[s("span",Ps,a(e.$t("dashboard.home.trafficReset")),1)])]),s("div",Zs,[s("div",Ks,[c(d(G),{size:18,class:"text-primary"}),s("span",Ys,a(e.$t("dashboard.home.remainingTraffic")),1)]),s("span",se,a(ls(i.value.transfer_enable-(i.value.u+i.value.d))),1),s("div",ee,[s("span",te,a(e.$t("dashboard.home.availableQuota")),1)])])])])):O.value&&!i.value?(n(),l("div",ae,[c(r,{active:"",paragraph:{rows:3}})])):(n(),l("div",oe,[s("span",null,a(e.$t("dashboard.home.noDataAvailable")),1)]))]),s("div",ie,[s("div",ne,[c(d(P),{size:18}),s("h3",null,a(e.$t("dashboard.home.importantNotices")),1)]),$.value.length>0?(n(),l("div",le,[(n(!0),l(T,null,L($.value,o=>(n(),l("div",{class:"notice-item",key:o.id,onClick:f=>ts(o)},[t[11]||(t[11]=s("div",{class:"n-icon"},"ðŸ“Œ",-1)),s("div",ce,[s("span",de,a(o.title),1),s("span",ue,a(new Date(o.created_at*1e3).toLocaleDateString()),1)]),c(d(ys),{size:16,class:"n-arrow"})],8,re))),128))])):(n(),l("div",he,[s("span",null,a(e.$t("dashboard.home.noNotices")),1)]))]),s("div",me,[s("div",ve,[s("div",pe,[s("div",_e,[s("h4",null,a(e.$t("dashboard.home.subscribeLink")),1),s("div",be,[s("input",{readonly:"",value:((F=i.value)==null?void 0:F.subscribe_url)||"https://link.example.com/...",class:"link-input"},null,8,ge),s("button",{onClick:rs,class:"copy-btn"},[c(d(Ns),{size:16})])])]),s("div",fe,[s("h4",null,a(e.$t("dashboard.home.oneClickImport")),1),s("div",ke,[s("div",{class:"import-item",onClick:t[0]||(t[0]=o=>g("clash"))},[...t[12]||(t[12]=[s("div",{class:"q-icon",title:"Clash"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Clash.9gwri62wr1.webp",alt:"Clash"})],-1),s("span",null,"Clash",-1)])]),s("div",{class:"import-item",onClick:t[1]||(t[1]=o=>g("shadowrocket"))},[...t[13]||(t[13]=[s("div",{class:"q-icon",title:"Shadowrocket"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Shadowrocket.8z6ptl1j67.webp",alt:"Shadowrocket"})],-1),s("span",null,"Shadowrocket",-1)])]),s("div",{class:"import-item",onClick:t[2]||(t[2]=o=>g("singbox"))},[...t[14]||(t[14]=[s("div",{class:"q-icon",title:"Singbox"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Singbox.espc7ryvj.svg",alt:"Singbox"})],-1),s("span",null,"Singbox",-1)])]),s("div",{class:"import-item",onClick:t[3]||(t[3]=o=>g("surfboard"))},[...t[15]||(t[15]=[s("div",{class:"q-icon",title:"Surfboard"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Surfboard.8vn3vv8ggg.svg",alt:"Surfboard"})],-1),s("span",null,"Surfboard",-1)])]),s("div",{class:"import-item",onClick:t[4]||(t[4]=o=>g("surge"))},[...t[16]||(t[16]=[s("div",{class:"q-icon",title:"Surge"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Surge.8s3hy5fdqo.svg",alt:"Surge"})],-1),s("span",null,"Surge",-1)])]),s("div",{class:"import-item",onClick:t[5]||(t[5]=o=>g("quantumult-x"))},[...t[17]||(t[17]=[s("div",{class:"q-icon",title:"Quantumult X"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Quantumult.102cyimf66.webp",alt:"Quantumult X"})],-1),s("span",null,"Quantumult X",-1)])]),s("div",we,[c(d(Z),{value:((Q=i.value)==null?void 0:Q.subscribe_url)||"https://xboard.link/placeholder",size:88,color:ss.value?"#F9FAFB":"#1E293B","bg-color":"transparent",status:(U=i.value)!=null&&U.subscribe_url?"active":"loading"},null,8,["value","color","status"]),s("p",null,a(e.$t("dashboard.home.scanToImport")),1)])])])]),s("div",ye,[s("h4",null,a(e.$t("dashboard.home.clientDownload")),1),s("div",Se,[(n(!0),l(T,null,L(C.value,(o,f)=>(n(),l("div",{key:f,class:"platform-group"},[(n(!0),l(T,null,L(o.clients,_=>(n(),l("a",{key:_.name,href:_.url,target:"_blank",class:"download-link"},[s("img",{src:_.icon,alt:_.name},null,8,$e),s("div",xe,[s("span",Ne,a(_.name),1),s("span",De,a(_.platform),1)])],8,Ce))),128))]))),128))])])])])]),c(k,{visible:x.value,"onUpdate:visible":t[7]||(t[7]=o=>x.value=o),footer:null,width:650,class:"notice-modal",centered:""},{title:N(()=>{var o;return[s("div",Oe,[s("div",Ie,[c(d(P),{size:18})]),s("span",ze,a((o=m.value)==null?void 0:o.title),1)])]}),default:N(()=>{var o;return[t[18]||(t[18]=s("div",{class:"modal-mesh"},null,-1)),u.value?(n(),l("div",{key:0,class:X(["promo-card-wrapper",u.value.theme||"default"])},[s("div",Re,[s("div",Je,[s("h2",{class:"promo-title",innerHTML:(o=u.value.title)==null?void 0:o.replace(/\\n/g,"<br>")},null,8,Te)]),s("div",Le,[s("p",Me,a(u.value.content),1),u.value.code?(n(),l("div",Be,[s("span",qe,a(e.$t("dashboard.home.recommendCode")),1),s("span",Ae,a(u.value.code),1)])):w("",!0)]),u.value.btnText?(n(),l("div",je,[s("button",{class:"promo-btn",onClick:t[6]||(t[6]=f=>as(u.value.btnRoute))},a(u.value.btnText),1)])):w("",!0)])],2)):(n(),l("div",{key:1,class:"notice-detail-content markdown-body",innerHTML:es.value},null,8,Ve)),s("div",Fe,[s("div",Qe,[c(d(y),{size:12}),s("span",null,a(m.value?new Date(m.value.created_at*1e3).toLocaleString():""),1)])])]}),_:1},8,["visible"]),c(k,{visible:I.value,"onUpdate:visible":t[8]||(t[8]=o=>I.value=o),footer:null,width:420,class:"checkin-modal",centered:""},{default:N(()=>{var o,f,_;return[s("div",Ue,[s("div",We,[s("div",Xe,[t[19]||(t[19]=s("div",{class:"ripple"},null,-1)),c(d(y),{size:48,class:"main-icon"})]),s("h2",He,a((o=v.value)!=null&&o.checked_in_today?e.$t("dashboard.home.checkinSuccess"):e.$t("dashboard.home.dailyCheckin")),1),s("p",Ee,a(e.$t("dashboard.home.checkinRulesDesc")),1)]),s("div",Ge,[s("div",Pe,[s("span",Ze,a(((f=v.value)==null?void 0:f.streak_days)||0),1),s("span",Ke,a(e.$t("dashboard.home.consecutiveDays")),1)])]),p.value?(n(),l("div",Ye,[s("div",st,[p.value.type==="traffic"?(n(),H(d(G),{key:0,size:24,class:"reward-icon traffic"})):(n(),H(d(y),{key:1,size:24,class:"reward-icon days"})),s("div",et,[s("span",tt,a(p.value.type==="traffic"?e.$t("dashboard.home.trafficReward"):e.$t("dashboard.home.dayReward")),1),s("span",at,"+"+a(p.value.value)+" "+a(p.value.unit),1)])])])):w("",!0),s("div",ot,[c(cs,{type:"primary",block:"",size:"large",class:"do-checkin-btn",loading:z.value,disabled:(_=v.value)==null?void 0:_.checked_in_today,onClick:ns},{default:N(()=>{var W;return[_s(a((W=v.value)!=null&&W.checked_in_today?e.$t("dashboard.home.alreadyCheckin"):e.$t("dashboard.home.checkinNow")),1)]}),_:1},8,["loading","disabled"])])])]}),_:1},8,["visible"])])}}}),bt=Ss(nt,[["__scopeId","data-v-7c21792a"]]);export{bt as default};
